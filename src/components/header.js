import { Link } from "gatsby"
import React, { useState, useEffect } from "react"
import Headroom from "react-headroom"

import NoSloganLogo from "../assets/svgs/global/noSloganLogo"
import Logo from "../assets/svgs/global/logo"

import BurgerMenu from "../components/header/mobile/index"

export default function Header({
  siteTitle,
  imageAssets,
  navigationLinks,
  navLinks,
}) {
  const [open, setOpen] = useState(false)
  useEffect(() => {
    if (open) {
      document.getElementsByClassName("main-blur")[0].style.filter = "blur(2px)"
      document.getElementsByClassName("main-blur")[0].style.overflow = "hidden"
      document.getElementById("logo-main-header").style.fill = "#252525"
      document.getElementById("logo-main-header").style.zIndex = "50"
    } else {
      const innerWidth = window.innerWidth
      if (window.innerWidth < 900) {
        document.getElementById("logo-main-header").style.fill = "black"
        document.getElementsByClassName("main-blur")[0].style.filter = "none"
      }
    }
  }, [open])

  return (
    <React.Fragment>
      <Headroom
        className="header-room-global"
        style={{
          backgroundColor: "white",

          borderBottom: "1px solid #dbd9d2",
          webkitTransition: "all .5s ease-in-out",
          mozTransition: "all .5s ease-in-out",
          oTransition: "all .5s ease-in-out",
          transition: "all .5s ease-in-out",
        }}
      >
        <div className="desktop-header wrap">
          <div className="container">
            <Link className="header-logo-link-home" to="/">
              <Logo />
            </Link>

            <div
              style={{
                display: "flex",
                justifyContent: "space-around",
                flexDirection: "column",
              }}
            >
              <section>
                <ul className="space-between">
                  <span>
                    <CanadaFlag />
                    <UnitedStatesFlag />
                    1-866-333-0334
                  </span>
                </ul>
              </section>
              <section>
                <ul className="second">
                  {navLinks.body.map((item, index) => {
                    return <NavLinkTypeResolver data={item} />
                  })}
                </ul>
              </section>
            </div>
          </div>
        </div>
      </Headroom>
      <header className="mobile-header">
        <div className="container wrap">
          <BurgerMenu links={navigationLinks} open={open} setOpen={setOpen} />
          <Link
            onClick={() => setOpen(false)}
            className="homepage-burger-link"
            to="/"
          >
            <NoSloganLogo passClass="logo-main-header" />
          </Link>
        </div>
      </header>
    </React.Fragment>
  )
}

function NavLinkTypeResolver({ data }) {
  const { slice_label } = data
  switch (slice_label) {
    case "normal-nav-link":
      return <NormalLink data={data} />
    case "drop-down-nav-link":
      return <DropDownCategoryMenu data={data} />
    default:
      return null
  }
}

const NormalLink = link => {
  const { uid } = link.data.primary.link_to_page
  if (link.data.primary.link_to_page) {
    return (
      <Link to={`/${uid}`} key={uid}>
        {uid}
        {/* {link_to_page} */}
      </Link>
    )
  }
  return null
}

const DropDownCategoryMenu = ({ data }) => {
  return (
    <div class="dropdown">
      <Link
        disabled={
          data.primary.parent_link && data.primary.parent_link.uid
            ? false
            : true
        }
        to={data.primary.parent_link && data.primary.parent_link.uid}
        style={{ marginLeft: "2.5em" }}
        className={`dropbtn`}
      >
        {data.primary.category_title && data.primary.category_title}
      </Link>
      <div class="dropdown-content">
        {data.items.map((item, index) => {
          console.log(item.link_to_page.uid)
          if (item && item.link_to_page) {
            return (
              <Link
                key={index}
                style={{
                  marginLeft: "0",
                  borderBottom: "1px solid rgb(219, 217, 210)",
                }}
                to={
                  data.primary.parent_link &&
                  data.primary.parent_link.uid === "projects"
                    ? `/${data.primary.parent_link.uid}/${item.link_to_page.uid}`
                    : `/${item.link_to_page.uid}`
                }
              >
                {item.link_to_page.document[0].data &&
                  item.link_to_page.document[0].data.title_of_page.text}
              </Link>
            )
          } else {
            return null
          }
        })}
      </div>
    </div>
  )
}

function UnitedStatesFlag() {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      x="0"
      y="0"
      height="2em"
      width="2em"
      version="1.1"
      viewBox="312 717.552 300 157.895"
      xmlSpace="preserve"
    >
      <switch>
        <g>
          <path fill="#FFF" d="M312 717.552H612V875.447H312z"></path>
          <path fill="#B22234" d="M312 717.552H612V729.698H312z"></path>
          <path fill="#B22234" d="M312 741.844H612V753.99H312z"></path>
          <path fill="#B22234" d="M312 766.135H612V778.281H312z"></path>
          <path fill="#B22234" d="M312 790.427H612V802.573H312z"></path>
          <path
            fill="#B22234"
            d="M312 814.718H612V826.8639999999999H312z"
          ></path>
          <path fill="#B22234" d="M312 839.01H612V851.156H312z"></path>
          <path fill="#B22234" d="M312 863.301H612V875.447H312z"></path>
          <path fill="#3C3B6E" d="M312 717.552H432V802.572H312z"></path>
          <path
            fill="#FFF"
            d="M317.638 724.454L320.497 726.531 319.405 729.892 322.263 727.815 325.122 729.892 324.03 726.531 326.888 724.454 323.355 724.454 322.263 721.094 321.171 724.454z"
          ></path>
          <path
            fill="#FFF"
            d="M337.533 724.454L340.391 726.531 339.299 729.892 342.158 727.815 345.017 729.892 343.925 726.531 346.783 724.454 343.25 724.454 342.158 721.094 341.066 724.454z"
          ></path>
          <path
            fill="#FFF"
            d="M357.428 724.454L360.286 726.531 359.194 729.892 362.053 727.815 364.911 729.892 363.819 726.531 366.678 724.454 363.145 724.454 362.053 721.094 360.961 724.454z"
          ></path>
          <path
            fill="#FFF"
            d="M377.323 724.454L380.181 726.531 379.089 729.892 381.948 727.815 384.806 729.892 383.714 726.531 386.573 724.454 383.039 724.454 381.948 721.094 380.856 724.454z"
          ></path>
          <path
            fill="#FFF"
            d="M397.217 724.454L400.076 726.531 398.984 729.892 401.842 727.815 404.701 729.892 403.609 726.531 406.467 724.454 402.934 724.454 401.842 721.094 400.75 724.454z"
          ></path>
          <path
            fill="#FFF"
            d="M417.112 724.454L419.97 726.531 418.878 729.892 421.737 727.815 424.595 729.892 423.503 726.531 426.362 724.454 422.829 724.454 421.737 721.094 420.645 724.454z"
          ></path>
          <path
            fill="#FFF"
            d="M327.585 732.981L330.444 735.058 329.352 738.418 332.211 736.341 335.069 738.418 333.977 735.058 336.836 732.981 333.302 732.981 332.211 729.62 331.119 732.981z"
          ></path>
          <path
            fill="#FFF"
            d="M347.48 732.981L350.339 735.058 349.247 738.418 352.105 736.341 354.964 738.418 353.872 735.058 356.73 732.981 353.197 732.981 352.105 729.62 351.013 732.981z"
          ></path>
          <path
            fill="#FFF"
            d="M367.375 732.981L370.234 735.058 369.142 738.418 372 736.341 374.859 738.418 373.767 735.058 376.625 732.981 373.092 732.981 372 729.62 370.908 732.981z"
          ></path>
          <path
            fill="#FFF"
            d="M387.27 732.981L390.128 735.058 389.036 738.418 391.895 736.341 394.753 738.418 393.661 735.058 396.52 732.981 392.987 732.981 391.895 729.62 390.803 732.981z"
          ></path>
          <path
            fill="#FFF"
            d="M407.164 732.981L410.023 735.058 408.931 738.418 411.789 736.341 414.648 738.418 413.556 735.058 416.414 732.981 412.881 732.981 411.789 729.62 410.698 732.981z"
          ></path>
          <path
            fill="#FFF"
            d="M317.638 741.507L320.497 743.584 319.405 746.945 322.263 744.868 325.122 746.945 324.03 743.584 326.888 741.507 323.355 741.507 322.263 738.147 321.171 741.507z"
          ></path>
          <path
            fill="#FFF"
            d="M337.533 741.507L340.391 743.584 339.299 746.945 342.158 744.868 345.017 746.945 343.925 743.584 346.783 741.507 343.25 741.507 342.158 738.147 341.066 741.507z"
          ></path>
          <path
            fill="#FFF"
            d="M357.428 741.507L360.286 743.584 359.194 746.945 362.053 744.868 364.911 746.945 363.819 743.584 366.678 741.507 363.145 741.507 362.053 738.147 360.961 741.507z"
          ></path>
          <path
            fill="#FFF"
            d="M377.323 741.507L380.181 743.584 379.089 746.945 381.948 744.868 384.806 746.945 383.714 743.584 386.573 741.507 383.039 741.507 381.948 738.147 380.856 741.507z"
          ></path>
          <path
            fill="#FFF"
            d="M397.217 741.507L400.076 743.584 398.984 746.945 401.842 744.868 404.701 746.945 403.609 743.584 406.467 741.507 402.934 741.507 401.842 738.147 400.75 741.507z"
          ></path>
          <path
            fill="#FFF"
            d="M417.112 741.507L419.97 743.584 418.878 746.945 421.737 744.868 424.595 746.945 423.503 743.584 426.362 741.507 422.829 741.507 421.737 738.147 420.645 741.507z"
          ></path>
          <path
            fill="#FFF"
            d="M327.831 750.062L330.689 752.139 329.598 755.499 332.456 753.422 335.315 755.499 334.223 752.138 337.081 750.062 333.548 750.062 332.456 746.701 331.364 750.062z"
          ></path>
          <path
            fill="#FFF"
            d="M347.726 750.062L350.584 752.139 349.492 755.499 352.351 753.422 355.209 755.499 354.117 752.138 356.976 750.062 353.443 750.062 352.351 746.701 351.259 750.062z"
          ></path>
          <path
            fill="#FFF"
            d="M367.621 750.062L370.479 752.139 369.387 755.499 372.246 753.422 375.104 755.499 374.012 752.138 376.871 750.062 373.337 750.062 372.246 746.701 371.154 750.062z"
          ></path>
          <path
            fill="#FFF"
            d="M387.515 750.062L390.374 752.139 389.282 755.499 392.14 753.422 394.999 755.499 393.907 752.138 396.765 750.062 393.232 750.062 392.14 746.701 391.048 750.062z"
          ></path>
          <path
            fill="#FFF"
            d="M407.41 750.062L410.268 752.139 409.176 755.499 412.035 753.422 414.893 755.499 413.801 752.138 416.66 750.062 413.127 750.062 412.035 746.701 410.943 750.062z"
          ></path>
          <path
            fill="#FFF"
            d="M317.94 758.517L320.799 760.593 319.707 763.954 322.565 761.877 325.424 763.954 324.332 760.593 327.19 758.517 323.657 758.517 322.565 755.156 321.473 758.517z"
          ></path>
          <path
            fill="#FFF"
            d="M337.835 758.517L340.693 760.593 339.601 763.954 342.46 761.877 345.318 763.954 344.227 760.593 347.085 758.517 343.552 758.517 342.46 755.156 341.368 758.517z"
          ></path>
          <path
            fill="#FFF"
            d="M357.73 758.517L360.588 760.593 359.496 763.954 362.355 761.877 365.213 763.954 364.121 760.593 366.98 758.517 363.447 758.517 362.355 755.156 361.263 758.517z"
          ></path>
          <path
            fill="#FFF"
            d="M377.624 758.517L380.483 760.593 379.391 763.954 382.249 761.877 385.108 763.954 384.016 760.593 386.875 758.517 383.341 758.517 382.249 755.156 381.158 758.517z"
          ></path>
          <path
            fill="#FFF"
            d="M397.519 758.517L400.377 760.593 399.286 763.954 402.144 761.877 405.003 763.954 403.911 760.593 406.769 758.517 403.236 758.517 402.144 755.156 401.052 758.517z"
          ></path>
          <path
            fill="#FFF"
            d="M417.414 758.517L420.272 760.593 419.18 763.954 422.039 761.877 424.897 763.954 423.805 760.593 426.664 758.517 423.131 758.517 422.039 755.156 420.947 758.517z"
          ></path>
          <path
            fill="#FFF"
            d="M318.127 775.299L320.985 777.376 319.893 780.737 322.752 778.66 325.61 780.737 324.518 777.376 327.377 775.299 323.844 775.299 322.752 771.939 321.66 775.299z"
          ></path>
          <path
            fill="#FFF"
            d="M338.021 775.299L340.88 777.376 339.788 780.737 342.646 778.66 345.505 780.737 344.413 777.376 347.271 775.299 343.738 775.299 342.646 771.939 341.554 775.299z"
          ></path>
          <path
            fill="#FFF"
            d="M357.916 775.299L360.774 777.376 359.683 780.737 362.541 778.66 365.4 780.737 364.308 777.376 367.166 775.299 363.633 775.299 362.541 771.939 361.449 775.299z"
          ></path>
          <path
            fill="#FFF"
            d="M377.811 775.299L380.669 777.376 379.577 780.737 382.436 778.66 385.294 780.737 384.203 777.376 387.061 775.299 383.528 775.299 382.436 771.939 381.344 775.299z"
          ></path>
          <path
            fill="#FFF"
            d="M397.705 775.299L400.564 777.376 399.472 780.737 402.33 778.66 405.189 780.737 404.097 777.376 406.956 775.299 403.422 775.299 402.33 771.939 401.239 775.299z"
          ></path>
          <path
            fill="#FFF"
            d="M417.6 775.299L420.458 777.376 419.367 780.737 422.225 778.66 425.084 780.737 423.992 777.376 426.85 775.299 423.317 775.299 422.225 771.939 421.133 775.299z"
          ></path>
          <path
            fill="#FFF"
            d="M317.884 792.279L320.742 794.356 319.65 797.717 322.509 795.64 325.367 797.717 324.275 794.356 327.134 792.279 323.6 792.279 322.509 788.919 321.417 792.279z"
          ></path>
          <path
            fill="#FFF"
            d="M337.778 792.279L340.637 794.356 339.545 797.717 342.403 795.64 345.262 797.717 344.17 794.356 347.028 792.279 343.495 792.279 342.403 788.919 341.311 792.279z"
          ></path>
          <path
            fill="#FFF"
            d="M357.673 792.279L360.531 794.356 359.44 797.717 362.298 795.64 365.157 797.717 364.065 794.356 366.923 792.279 363.39 792.279 362.298 788.919 361.206 792.279z"
          ></path>
          <path
            fill="#FFF"
            d="M377.568 792.279L380.426 794.356 379.334 797.717 382.193 795.64 385.051 797.717 383.96 794.356 386.818 792.279 383.285 792.279 382.193 788.919 381.101 792.279z"
          ></path>
          <path
            fill="#FFF"
            d="M397.462 792.279L400.321 794.356 399.229 797.717 402.087 795.64 404.946 797.717 403.854 794.356 406.713 792.279 403.179 792.279 402.087 788.919 400.996 792.279z"
          ></path>
          <path
            fill="#FFF"
            d="M417.357 792.279L420.215 794.356 419.124 797.717 421.982 795.64 424.841 797.717 423.749 794.356 426.607 792.279 423.074 792.279 421.982 788.919 420.89 792.279z"
          ></path>
          <path
            fill="#FFF"
            d="M327.89 766.824L330.748 768.901 329.657 772.261 332.515 770.184 335.374 772.261 334.282 768.901 337.14 766.824 333.607 766.824 332.515 763.463 331.423 766.824z"
          ></path>
          <path
            fill="#FFF"
            d="M347.785 766.824L350.643 768.901 349.551 772.261 352.41 770.184 355.268 772.261 354.177 768.901 357.035 766.824 353.502 766.824 352.41 763.463 351.318 766.824z"
          ></path>
          <path
            fill="#FFF"
            d="M367.68 766.824L370.538 768.901 369.446 772.261 372.305 770.184 375.163 772.261 374.071 768.901 376.93 766.824 373.397 766.824 372.305 763.463 371.213 766.824z"
          ></path>
          <path
            fill="#FFF"
            d="M387.574 766.824L390.433 768.901 389.341 772.261 392.199 770.184 395.058 772.261 393.966 768.901 396.824 766.824 393.291 766.824 392.199 763.463 391.107 766.824z"
          ></path>
          <path
            fill="#FFF"
            d="M407.469 766.824L410.327 768.901 409.235 772.261 412.094 770.184 414.952 772.261 413.861 768.901 416.719 766.824 413.186 766.824 412.094 763.463 411.002 766.824z"
          ></path>
          <path
            fill="#FFF"
            d="M327.831 783.777L330.69 785.854 329.598 789.215 332.456 787.138 335.315 789.215 334.223 785.854 337.081 783.777 333.548 783.777 332.456 780.417 331.364 783.777z"
          ></path>
          <path
            fill="#FFF"
            d="M347.726 783.777L350.584 785.854 349.492 789.215 352.351 787.138 355.21 789.215 354.118 785.854 356.976 783.777 353.443 783.777 352.351 780.417 351.259 783.777z"
          ></path>
          <path
            fill="#FFF"
            d="M367.621 783.777L370.479 785.854 369.387 789.215 372.246 787.138 375.104 789.215 374.012 785.854 376.871 783.777 373.338 783.777 372.246 780.417 371.154 783.777z"
          ></path>
          <path
            fill="#FFF"
            d="M387.515 783.777L390.374 785.854 389.282 789.215 392.14 787.138 394.999 789.215 393.907 785.854 396.765 783.777 393.232 783.777 392.14 780.417 391.048 783.777z"
          ></path>
          <path
            fill="#FFF"
            d="M407.41 783.777L410.268 785.854 409.176 789.215 412.035 787.138 414.893 789.215 413.802 785.854 416.66 783.777 413.127 783.777 412.035 780.417 410.943 783.777z"
          ></path>
        </g>
      </switch>
    </svg>
  )
}

function CanadaFlag() {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      x="0"
      y="0"
      height="2em"
      width="2em"
      version="1.1"
      viewBox="194.5 646.5 300 150"
      xmlSpace="preserve"
    >
      <switch>
        <g>
          <path fill="red" d="M194.5 646.5H494.5V796.5H194.5z"></path>
          <path fill="#FFF" d="M269.5 646.5H419.5V796.5H269.5z"></path>
          <path
            fill="red"
            d="M344.498 660.562l-10.234 19.088c-1.161 2.074-3.242 1.882-5.323.723l-7.409-3.837 5.522 29.318c1.161 5.356-2.564 5.356-4.403 3.04l-12.93-14.475-2.099 7.351c-.242.965-1.307 1.979-2.903 1.738l-16.351-3.438 4.295 15.613c.919 3.474 1.637 4.912-.928 5.829l-5.828 2.739 28.146 22.862c1.114.865 1.677 2.42 1.281 3.829l-2.464 8.084c9.691-1.117 18.375-2.798 28.071-3.833.856-.091 2.289 1.321 2.283 2.313l-1.284 29.617h4.712l-.742-29.554c-.006-.992 1.294-2.468 2.15-2.377 9.696 1.035 18.38 2.716 28.071 3.833l-2.464-8.084c-.396-1.409.166-2.964 1.281-3.829l28.146-22.863-5.828-2.739c-2.565-.916-1.847-2.355-.928-5.829l4.295-15.613-16.351 3.438c-1.597.241-2.661-.772-2.903-1.738l-2.099-7.351-12.93 14.476c-1.839 2.316-5.565 2.316-4.403-3.04l5.522-29.318-7.409 3.837c-2.081 1.159-4.161 1.351-5.323-.723"
          ></path>
        </g>
      </switch>
    </svg>
  )
}
